<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Relatório Comparativo IMACX 2025</title>
<!-- Import Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<!-- Import FontAwesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<!-- Import Google Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet">

<style>
    /* ============================================
    TOKENS & BASE
    ============================================ */
    :root {
        --spacing-unit: 8px;
        --max-width: 1600px;

        /* Colors */
        --accent-100: #ff9900;
        --accent-200: #e68a00;
        
        --background: #050505;
        --surface: #121212;
        --surface-highlight: #1e1e1e;
        
        --foreground: #f0f0f0;
        --muted: #a0a0a0;
        --border: #333333;
        
        --success: #10b981;
        --warning: #f59e0b;
        --destructive: #ef4444;

        /* Typography */
        --font-sans: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        --font-mono: "JetBrains Mono", monospace;
    }

    * { box-sizing: border-box; }

    body {
        background: var(--background);
        color: var(--foreground);
        font-family: var(--font-mono);
        margin: 0;
        padding: 0;
        line-height: 1.6;
        overflow-x: hidden;
    }

    /* ============================================
    LAYOUT
    ============================================ */
    header {
        background: rgba(5, 5, 5, 0.8);
        backdrop-filter: blur(10px);
        position: sticky;
        top: 0;
        z-index: 100;
        border-bottom: 1px solid var(--border);
        padding: 1rem 0;
    }

    .header-content {
        max-width: var(--max-width);
        margin: 0 auto;
        padding: 0 60px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .logo {
        font-weight: 700;
        font-size: 1.2rem;
        letter-spacing: -0.02em;
        color: var(--accent-100);
    }

    .report-tag {
        font-family: var(--font-mono);
        font-size: 0.8rem;
        color: var(--muted);
        border: 1px solid var(--border);
        padding: 4px 10px;
        border-radius: 99px;
    }

    main {
        padding-bottom: 80px;
    }

    section {
        padding: 60px 60px;
        border-bottom: 1px solid var(--border);
        background: var(--background);
    }

    section:nth-child(even) {
        background: var(--surface);
    }

    .container {
        max-width: var(--max-width);
        margin: 0 auto;
    }

    /* ============================================
    TYPOGRAPHY
    ============================================ */
    h1, h2, h3 {
        margin: 0;
        line-height: 1.2;
        font-family: var(--font-mono);
    }

    h1 {
        font-size: clamp(2.5rem, 5vw, 3.5rem);
        font-weight: 700;
        letter-spacing: -0.03em;
        margin-bottom: 1rem;
        font-family: var(--font-mono);
    }

    .section-title {
        font-size: clamp(1.8rem, 3vw, 2.5rem);
        font-weight: 700;
        margin-bottom: 0.5rem;
        color: var(--foreground);
        font-family: var(--font-mono);
    }

    .section-subtitle {
        font-size: 1.1rem;
        color: var(--muted);
        margin-bottom: 3rem;
        font-weight: 400;
        max-width: 700px;
        font-family: var(--font-mono);
    }

    h3 {
        font-size: 1.25rem;
        font-weight: 600;
        margin-bottom: 1rem;
        color: var(--accent-100);
        font-family: var(--font-mono);
    }

    p { 
        margin-bottom: 1rem; 
        color: var(--muted); 
        font-family: var(--font-mono);
    }
    strong { 
        color: var(--foreground); 
        font-weight: 600; 
        font-family: var(--font-mono);
    }

    /* ============================================
    COMPONENTS
    ============================================ */
    /* Cover Section */
    .cover-section {
        min-height: 80vh;
        display: flex;
        flex-direction: column;
        justify-content: center;
        position: relative;
        overflow: hidden;
        padding-top: 100px;
    }

    .hero-badge {
        display: inline-block;
        background: rgba(255, 153, 0, 0.15);
        color: var(--accent-100);
        padding: 8px 16px;
        border-radius: 4px;
        font-family: var(--font-mono);
        font-size: 0.9rem;
        margin-bottom: 24px;
        border: 1px solid rgba(255, 153, 0, 0.3);
    }

    .vs-text {
        color: var(--accent-100);
        font-family: var(--font-mono);
        font-style: italic;
        margin: 0 0.2em;
    }

    .data-warning {
        background: rgba(20, 20, 20, 0.8);
        border: 1px dashed var(--border);
        padding: 20px;
        border-radius: 8px;
        margin-top: 40px;
        max-width: 800px;
        font-size: 0.9rem;
        display: flex;
        gap: 12px;
        align-items: flex-start;
    }

    /* Grid System */
    .grid-3 {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 24px;
    }

    .grid-2 {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        gap: 40px;
        align-items: stretch;
    }

    /* Cards */
    .card {
        background: var(--surface-highlight);
        border: 1px solid var(--border);
        border-radius: 8px;
        padding: 24px;
        transition: transform 0.2s, border-color 0.2s;
    }

    .card:hover {
        border-color: var(--accent-200);
        transform: translateY(-2px);
    }

    .metric-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 16px;
    }

    .metric-label {
        font-size: 0.85rem;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        font-weight: 600;
        color: var(--muted);
    }

    .badge {
        font-size: 0.75rem;
        font-weight: 700;
        padding: 4px 8px;
        border-radius: 4px;
        font-family: var(--font-mono);
    }

    .badge-destructive { background: rgba(239, 68, 68, 0.2); color: var(--destructive); }
    .badge-warning { background: rgba(245, 158, 11, 0.2); color: var(--warning); }
    .badge-success { background: rgba(16, 185, 129, 0.2); color: var(--success); }

    .metric-row {
        display: flex;
        justify-content: space-between;
        align-items: baseline;
        margin-bottom: 8px;
        padding-bottom: 8px;
        border-bottom: 1px solid rgba(255,255,255,0.05);
    }

    .metric-row:last-child { border-bottom: none; margin-bottom: 0; padding-bottom: 0; }

    .row-main { font-size: 1.5rem; font-weight: 700; color: var(--foreground); }
    .row-sub { font-size: 1.1rem; color: var(--muted); }
    .unit { font-size: 0.8rem; color: var(--muted); margin-right: 8px; font-family: var(--font-mono); }

    /* Insights List */
    .insights-box {
        background: rgba(255,255,255,0.03);
        border-radius: 8px;
        padding: 24px;
        margin-top: 32px;
    }

    .insights-list {
        list-style: none;
        padding: 0;
        margin: 0;
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 16px;
    }

    .insights-list li {
        position: relative;
        padding-left: 24px;
        font-size: 0.95rem;
    }

    .insights-list li::before {
        content: "→";
        color: var(--accent-100);
        position: absolute;
        left: 0;
        top: 0;
        font-weight: bold;
    }

    /* Charts */
    .chart-container {
        position: relative;
        height: 350px;
        width: 100%;
        margin: 24px 0;
        background: var(--surface-highlight);
        border: 1px solid var(--border);
        border-radius: 8px;
        padding: 16px;
    }

    /* Funnel */
    .funnel-wrapper {
        display: flex;
        justify-content: center;
        gap: 60px;
        flex-wrap: wrap;
        margin: 40px 0;
    }

    .funnel-col {
        flex: 1;
        min-width: 280px;
        max-width: 400px;
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    .funnel-header {
        text-align: center;
        margin-bottom: 20px;
        font-weight: 700;
        letter-spacing: 0.05em;
    }

    .funnel-block {
        width: 100%;
        text-align: center;
        padding: 20px;
        color: white;
        margin-bottom: 4px;
        position: relative;
    }

    .funnel-top { clip-path: polygon(0% 0%, 100% 0%, 85% 100%, 15% 100%); height: 120px; display: flex; flex-direction: column; justify-content: center; }
    .funnel-bottom { clip-path: polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%); width: 70%; height: 100px; display: flex; flex-direction: column; justify-content: center; }
    
    .f-num { font-size: 2rem; font-weight: 700; line-height: 1; }
    .f-label { font-size: 0.8rem; text-transform: uppercase; opacity: 0.8; margin-top: 5px; }

    .conversion-pill {
        background: #000;
        border: 1px solid var(--border);
        padding: 8px 16px;
        border-radius: 20px;
        font-weight: 700;
        font-family: var(--font-mono);
        margin: -20px 0;
        z-index: 10;
        position: relative;
    }

    .bg-grad-orange { background: linear-gradient(180deg, var(--accent-200), rgba(230, 138, 0, 0.5)); }
    .bg-flat-orange { background: rgba(230, 138, 0, 0.3); }
    .bg-grad-red { background: linear-gradient(180deg, var(--destructive), rgba(239, 68, 68, 0.5)); }
    .bg-flat-red { background: rgba(239, 68, 68, 0.3); }

    /* Recommendations */
    .rec-item {
        display: grid;
        grid-template-columns: 60px 1fr;
        gap: 20px;
        margin-bottom: 30px;
        background: var(--surface-highlight);
        padding: 24px;
        border-radius: 8px;
        border-left: 4px solid var(--border);
    }

    .rec-item.priority-high { border-left-color: var(--destructive); }
    .rec-item.priority-med { border-left-color: var(--warning); }

    .rec-number {
        width: 40px;
        height: 40px;
        background: #333;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        color: white;
    }
    
    .priority-high .rec-number { background: var(--destructive); }

    .rec-stats {
        display: flex;
        gap: 20px;
        margin-top: 16px;
        flex-wrap: wrap;
    }

    .stat-chip {
        background: rgba(0,0,0,0.3);
        padding: 8px 12px;
        border-radius: 4px;
        font-size: 0.85rem;
    }
    
    .stat-val { font-weight: 700; color: var(--foreground); }
    .stat-lbl { color: var(--muted); font-size: 0.75rem; text-transform: uppercase; display: block; margin-bottom: 2px; }

    /* Tree / Root Cause Styles */
    .root-cause-wrapper {
        display: flex;
        flex-direction: column;
        height: 100%;
    }
    .root-cause-wrapper .rc-tree {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 100%;
        justify-content: center;
    }
    .traffic-light-col {
        display: flex;
        flex-direction: column;
        height: 100%;
        justify-content: space-between;
    }
    .traffic-light-col > .card:last-child {
        margin-bottom: 0;
    }
    .rc-tree { display: flex; flex-direction: column; align-items: center; width: 100%; }
    .rc-node { background: var(--surface-highlight); border: 1px solid var(--border); padding: 10px; border-radius: 6px; text-align: center; position: relative; }
    .rc-primary { background: var(--destructive); color: white; width: 100%; max-width: 400px; padding: 15px; font-weight: bold; box-shadow: 0 4px 20px rgba(239, 68, 68, 0.2); }
    .rc-secondary { flex: 1; font-size: 0.9rem; border-top: 3px solid var(--destructive); }
    .rc-tertiary { flex: 1; font-size: 0.8rem; border-top: 2px solid var(--muted); }
    .rc-row { display: flex; justify-content: space-between; width: 100%; gap: 10px; }
    .rc-title { font-weight: 600; margin-bottom: 4px; line-height: 1.3; }
    .rc-metric { font-family: var(--font-mono); font-size: 0.85em; opacity: 0.9; margin-top: 4px; }
    .rc-connector-v { width: 2px; height: 20px; background: var(--border); margin: 0 auto; }
    .simple-list { list-style: none; padding: 0; margin: 0; }
    .simple-list li { margin-bottom: 8px; font-size: 0.95rem; padding-left: 20px; position: relative; }
    .simple-list li::before { content: "•"; position: absolute; left: 0; color: var(--muted); font-weight: bold; }
    
    /* Utils */
    .text-red { color: var(--destructive); }
    .text-green { color: var(--success); }
    .text-orange { color: var(--accent-100); }
    
    @media (max-width: 768px) {
        h1 { font-size: 2.5rem; }
        .section-title { font-size: 1.8rem; }
        .funnel-wrapper { gap: 40px; }
        .header-content {
            padding: 0 20px;
        }
        section {
            padding: 40px 20px;
        }
    }
    
    @media (max-width: 1200px) {
        .header-content {
            padding: 0 40px;
        }
        section {
            padding: 60px 40px;
        }
    }
</style>
</head>
<body>

<header>
    <div class="header-content">
        <div class="logo">IMACX <span style="color:white"></span></div>
        <div class="report-tag">RELATÓRIO 2025</div>
    </div>
</header>

<main>
    <!-- CAPA -->
    <section class="cover-section">
        <div class="container">
            <span class="hero-badge">RELATÓRIO EXECUTIVO</span>
            <h1>Análise Comparativa<br>DIGITAL <span class="vs-text">vs</span> IMACX</h1>
            <p class="section-subtitle">Avaliação de performance YTD 2025, análise de gaps e plano estratégico de correção.</p>
            
            <div class="data-warning">
                <i class="fas fa-exclamation-triangle text-orange" style="margin-top: 4px;"></i>
                <div>
                    <strong>NOTA METODOLÓGICA CRÍTICA</strong><br>
                    Dados DIGITAL ajustados para remover 248 orçamentos "fantasma" gerados automaticamente pelo PHC (duplicação em faturas do cliente HH Group). A análise apresentada reflete a taxa de conversão real (45.4% vs 37.1% original).
                </div>
            </div>
        </div>
    </section>

    <!-- SUMÁRIO EXECUTIVO -->
    <section>
        <div class="container">
            <h2 class="section-title">Sumário Executivo</h2>
            <p class="section-subtitle">Visão geral dos principais indicadores de performance (KPIs) comparados.</p>
            
            <div class="grid-3">
                <div class="card">
                    <div class="metric-header">
                        <span class="metric-label">Receita Total</span>
                        <span class="badge badge-destructive">IMACX +177%</span>
                    </div>
                    <div class="metric-row">
                        <div><span class="unit">DIGITAL</span> €937,470</div>
                    </div>
                    <div class="metric-row">
                        <div class="row-main"><span class="unit">IMACX</span> €2,600,263</div>
                    </div>
                </div>

                <div class="card">
                    <div class="metric-header">
                        <span class="metric-label">Volume Faturas</span>
                        <span class="badge badge-destructive">IMACX +383%</span>
                    </div>
                    <div class="metric-row">
                        <div><span class="unit">DIGITAL</span> 317</div>
                    </div>
                    <div class="metric-row">
                        <div class="row-main"><span class="unit">IMACX</span> 1,530</div>
                    </div>
                </div>

                <div class="card">
                    <div class="metric-header">
                        <span class="metric-label">Clientes Ativos</span>
                        <span class="badge badge-destructive">IMACX +232%</span>
                    </div>
                    <div class="metric-row">
                        <div><span class="unit">DIGITAL</span> 31</div>
                    </div>
                    <div class="metric-row">
                        <div class="row-main"><span class="unit">IMACX</span> 103</div>
                    </div>
                </div>

                <div class="card">
                    <div class="metric-header">
                        <span class="metric-label">Orçamentos</span>
                        <span class="badge badge-destructive">IMACX +305%</span>
                    </div>
                    <div class="metric-row">
                        <div><span class="unit">DIGITAL</span> 699</div>
                    </div>
                    <div class="metric-row">
                        <div class="row-main"><span class="unit">IMACX</span> 2,836</div>
                    </div>
                </div>

                <div class="card">
                    <div class="metric-header">
                        <span class="metric-label">Taxa Conversão</span>
                        <span class="badge badge-warning">Gap -15.9%</span>
                    </div>
                    <div class="metric-row">
                        <div><span class="unit">DIGITAL</span> 45.4%</div>
                    </div>
                    <div class="metric-row">
                        <div class="row-main"><span class="unit">IMACX</span> 54.0%</div>
                    </div>
                </div>

                <div class="card" style="border-color: rgba(16, 185, 129, 0.3);">
                    <div class="metric-header">
                        <span class="metric-label text-green">Ticket Médio</span>
                        <span class="badge badge-success">DIGITAL +74%</span>
                    </div>
                    <div class="metric-row">
                        <div class="row-main text-green"><span class="unit">DIGITAL</span> €2,958</div>
                    </div>
                    <div class="metric-row">
                        <div class="row-sub"><span class="unit">IMACX</span> €1,700</div>
                    </div>
                </div>
            </div>

            <div class="insights-box">
                <h3>Insights Principais</h3>
                <ul class="insights-list">
                    <li>IMACX gera <strong>3.3x mais clientes</strong> e <strong>2.8x mais receita</strong>.</li>
                    <li>Causa Raiz: <strong>Atividade comercial insuficiente</strong> na DIGITAL (pipeline de orçamentos é 4x menor).</li>
                    <li>O <strong>Ticket Médio</strong> é o único indicador onde a DIGITAL supera a IMACX (+74%), validando o posicionamento premium.</li>
                    <li><strong>Risco Crítico:</strong> 78.3% da receita DIGITAL depende de um único cliente (HH Group).</li>
                </ul>
            </div>
        </div>
    </section>

    <!-- NOTA METODOLÓGICA -->
    <section>
        <div class="container">
            <h2 class="section-title">Nota Metodológica: Correção de Dados</h2>
            <p class="section-subtitle">Processo de ajuste para remover distorções automáticas geradas pelo sistema PHC.</p>
            
            <div class="grid-3">
                <!-- Passo 1 -->
                <div class="card">
                    <div class="metric-header">
                        <span class="metric-label">Passo 1</span>
                        <span class="badge badge-destructive">Problema</span>
                    </div>
                    <h3>Problema Identificado</h3>
                    <p>Orcamentos duplicados para HH Hroup, quando há faturas. Correção aplicada.</p>
                    
                    <div class="metric-row" style="margin-top: auto;">
                        <div class="row-sub">Cliente Único HH Group</div>
                    </div>
                    <div class="metric-row">
                        <div class="row-main">78.3% <span class="unit">da receita</span></div>
                    </div>
                </div>

                <!-- Passo 2 -->
                <div class="card">
                    <div class="metric-header">
                        <span class="metric-label">Passo 2</span>
                        <span class="badge badge-warning">Ajuste</span>
                    </div>
                    <h3>Ajuste Aplicado</h3>
                    <p>Facturas HH Group estimadas: 248 (78.3% de 317 facturas totais).</p>
                    
                    <div class="metric-row" style="margin-top: auto;">
                        <div class="row-sub">Orçamentos fantasma</div>
                    </div>
                    <div class="metric-row">
                        <div class="row-main text-red">-248 <span class="unit">removidos</span></div>
                    </div>
                </div>

                <!-- Passo 3 -->
                <div class="card" style="border-color: var(--success);">
                    <div class="metric-header">
                        <span class="metric-label">Passo 3</span>
                        <span class="badge badge-success">Resultado</span>
                    </div>
                    <h3>Dados Corrigidos</h3>
                    <p>Orçamentos reais = 699 (vs 947 originais).</p>
                    
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-top: 20px; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 10px;">
                        <div>
                            <div class="unit">Original</div>
                            <div class="row-main" style="font-size: 1.2rem; color: var(--muted); text-decoration: line-through;">37.1%</div>
                        </div>
                        <i class="fas fa-arrow-right text-green"></i>
                        <div style="text-align: right;">
                            <div class="unit">Corrigida</div>
                            <div class="row-main text-green">45.4%</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="insights-box">
                <h2 style="font-size: 1.5rem; margin-bottom: 20px;">Porquê esta Correção?</h2>
                <ul class="insights-list">
                    <li>Orcamentos duplicados para HH Hroup, quando há faturas. Correção aplicada</li>
                    <li>Estes orçamentos são <strong class="text-orange">fantasmas</strong> - nunca existiram como oportunidades reais de negócio.</li>
                    <li>A inclusão destes documentos artificialmente <strong class="text-red">reduz a taxa de conversão</strong> do departamento DIGITAL.</li>
                    <li>O ajuste permite <strong class="text-green">comparação justa</strong> com IMACX, revelando que a conversão DIGITAL é competitiva (45.4%).</li>
                    <li>Mesmo com correção, <strong class="text-orange">o problema primário persiste</strong>: volume de oportunidades comerciais insuficiente (-75.4% vs IMACX).</li>
                </ul>
            </div>
        </div>
    </section>

    <!-- PERFORMANCE GRÁFICA -->
    <section>
        <div class="container">
            <h2 class="section-title">Performance Global (Normalizado)</h2>
            <p class="section-subtitle">Comparativo DIGITAL como % do IMACX (Baseline = 100).</p>
            
            <div class="chart-container">
                <canvas id="performanceChart"></canvas>
            </div>
            
            <div class="insights-box">
                <h3 style="margin-bottom: 20px;">Insights Principais</h3>
                <ul class="insights-list" style="grid-template-columns: 1fr;">
                    <li><strong class="text-orange">Única vantagem competitiva:</strong> ticket médio <strong class="text-green">73.9% superior</strong> ao IMACX (€2,958 vs €1,700).</li>
                    <li>Conversão comercial <strong class="text-muted">moderadamente inferior</strong> (-15.9%), mas ainda competitiva (45.4% vs 54.0%).</li>
                    <li><strong class="text-red">Déficit crítico</strong> em todos indicadores de volume: receita (-64.0%), faturas (-79.3%), clientes (-69.9%).</li>
                    <li>O <strong class="text-orange">gap de atividade comercial</strong> (-75.4% orçamentos) é o fator determinante da baixa performance geral.</li>
                    <li><strong>Conclusão:</strong> estratégia premium (preços altos) não compensa volume insuficiente, resultando em receita total 2.8x menor.</li>
                </ul>
            </div>
        </div>
    </section>

    <!-- ESTRATÉGIA PRECIFICAÇÃO -->
    <section>
        <div class="container">
            <h2 class="section-title">Estratégia de Precificação</h2>
            <p class="section-subtitle">Trade-off Preço vs Volume: Análise de Posicionamento.</p>

            <div class="grid-2">
                <!-- Chart Side -->
                <div class="chart-container" style="height: 600px;">
                    <canvas id="bubbleChart"></canvas>
                </div>

                <!-- Content Side -->
                <div style="display: flex; flex-direction: column; gap: 20px;">
                    
                    <!-- Mini KPI Cards -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="card" style="padding: 15px; border-top: 3px solid var(--accent-100);">
                            <div class="metric-label text-orange" style="font-size: 0.7rem;">DIGITAL Premium Strategy</div>
                            <div class="row-main text-orange" style="font-size: 1.1rem;">+74% Ticket</div>
                        </div>
                        <div class="card" style="padding: 15px; border-top: 3px solid var(--destructive);">
                            <div class="metric-label text-red" style="font-size: 0.7rem;">IMACX Volume Strategy</div>
                            <div class="row-main text-red" style="font-size: 1.1rem;">+383% Faturas</div>
                        </div>
                    </div>

                    <div class="insights-box" style="margin-top: 0; flex-grow: 1;">
                        <h3 style="margin-bottom: 15px;">Insights Estratégicos</h3>
                        <ul class="insights-list" style="grid-template-columns: 1fr;">
                            <li>A estratégia <strong class="text-red">volume-led</strong> da IMACX produz resultado <strong>2.8x superior</strong> em receita total vs estratégia premium da DIGITAL.</li>
                            <li>DIGITAL cobra <strong class="text-orange">+74% de ticket médio</strong> (€2,958 vs €1,700), mas processa <strong class="text-red">-79% de faturas</strong> (317 vs 1,530).</li>
                            <li>DIGITAL fatura €937K com posicionamento premium, enquanto IMACX atinge €2.6M com abordagem volumétrica.</li>
                            <li>O <strong class="text-red">volume insuficiente</strong> não é compensado pelo ticket superior - indicando necessidade de reajuste estratégico.</li>
                            <li><strong class="text-green">Recomendação:</strong> Testar redução de 20% no ticket médio para segmento &lt;€10K, buscando aumentar volume sem sacrificar demasiadamente a margem.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- DINÂMICA BASE CLIENTES -->
    <section>
        <div class="container">
            <h2 class="section-title">Dinâmica da Base de Clientes</h2>
            <p class="section-subtitle">Movimentação de Base de Clientes (YTD): Aquisição vs Retenção.</p>

            <div class="grid-2" style="gap: 40px;">
                <!-- DIGITAL -->
                <div style="display: flex; flex-direction: column; height: 100%;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; flex-shrink: 0;">
                        <h3 style="margin:0;">DIGITAL</h3>
                        <div class="badge badge-destructive">Crescimento Líquido -13.9%</div>
                    </div>
                    
                    <div class="chart-container" style="height: 350px; position: relative; flex-shrink: 0;">
                        <canvas id="digitalWaterfall" style="width: 100%; height: 100%;"></canvas>
                    </div>

                    <div class="metrics-container" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-top: 20px; flex-shrink: 0;">
                        <div class="card" style="padding: 15px; text-align: center;">
                            <p class="metric-label" style="font-size: 0.75rem; margin-bottom: 5px; font-family: var(--font-mono);">Crescimento Líquido</p>
                            <p class="metric-value" style="font-size: 1.2rem; font-weight: 700; color: var(--destructive); font-family: var(--font-mono);">-5 (-13.9%)</p>
                        </div>
                        <div class="card" style="padding: 15px; text-align: center;">
                            <p class="metric-label" style="font-size: 0.75rem; margin-bottom: 5px; font-family: var(--font-mono);">Taxa de Churn</p>
                            <p class="metric-value" style="font-size: 1.2rem; font-weight: 700; color: var(--destructive); font-family: var(--font-mono);">35.4%</p>
                        </div>
                        <div class="card" style="padding: 15px; text-align: center;">
                            <p class="metric-label" style="font-size: 0.75rem; margin-bottom: 5px; font-family: var(--font-mono);">Aquisição</p>
                            <p class="metric-value" style="font-size: 1.2rem; font-weight: 700; color: var(--accent-100); font-family: var(--font-mono);">25.0%</p>
                        </div>
                    </div>

                    <div class="legend-container" style="display: flex; justify-content: center; gap: 20px; margin-top: 15px; flex-wrap: wrap; flex-shrink: 0;">
                        <div class="legend-item" style="display: flex; align-items: center; gap: 8px;">
                            <div class="legend-color" style="width: 16px; height: 16px; background: #0ea5e9; border-radius: 2px;"></div>
                            <span style="font-size: 0.85rem; color: var(--muted); font-family: var(--font-mono);">Início</span>
                        </div>
                        <div class="legend-item" style="display: flex; align-items: center; gap: 8px;">
                            <div class="legend-color" style="width: 16px; height: 16px; background: #10b981; border-radius: 2px;"></div>
                            <span style="font-size: 0.85rem; color: var(--muted); font-family: var(--font-mono);">Aquisição</span>
                        </div>
                        <div class="legend-item" style="display: flex; align-items: center; gap: 8px;">
                            <div class="legend-color" style="width: 16px; height: 16px; background: #ef4444; border-radius: 2px;"></div>
                            <span style="font-size: 0.85rem; color: var(--muted); font-family: var(--font-mono);">Perda</span>
                        </div>
                        <div class="legend-item" style="display: flex; align-items: center; gap: 8px;">
                            <div class="legend-color" style="width: 16px; height: 16px; background: #f59e0b; border-radius: 2px;"></div>
                            <span style="font-size: 0.85rem; color: var(--muted); font-family: var(--font-mono);">Final</span>
                        </div>
                    </div>
                </div>

                <!-- IMACX -->
                <div style="display: flex; flex-direction: column; height: 100%;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; flex-shrink: 0;">
                        <h3 style="margin:0;">IMACX</h3>
                        <div class="badge" style="background: #333;">Crescimento Líquido 0.0%</div>
                    </div>
                    
                    <div class="chart-container" style="height: 350px; position: relative; flex-shrink: 0;">
                        <canvas id="imacxWaterfall" style="width: 100%; height: 100%;"></canvas>
                    </div>

                    <div class="metrics-container" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-top: 20px; flex-shrink: 0;">
                        <div class="card" style="padding: 15px; text-align: center;">
                            <p class="metric-label" style="font-size: 0.75rem; margin-bottom: 5px; font-family: var(--font-mono);">Crescimento Líquido</p>
                            <p class="metric-value" style="font-size: 1.2rem; font-weight: 700; color: var(--muted); font-family: var(--font-mono);">0 (0.0%)</p>
                        </div>
                        <div class="card" style="padding: 15px; text-align: center;">
                            <p class="metric-label" style="font-size: 0.75rem; margin-bottom: 5px; font-family: var(--font-mono);">Taxa de Churn</p>
                            <p class="metric-value" style="font-size: 1.2rem; font-weight: 700; color: var(--destructive); font-family: var(--font-mono);">47.9%</p>
                        </div>
                        <div class="card" style="padding: 15px; text-align: center;">
                            <p class="metric-label" style="font-size: 0.75rem; margin-bottom: 5px; font-family: var(--font-mono);">Ativos</p>
                            <p class="metric-value" style="font-size: 1.2rem; font-weight: 700; color: var(--foreground); font-family: var(--font-mono);">103</p>
                        </div>
                    </div>

                    <div class="legend-container" style="display: flex; justify-content: center; gap: 20px; margin-top: 15px; flex-wrap: wrap; flex-shrink: 0;">
                        <div class="legend-item" style="display: flex; align-items: center; gap: 8px;">
                            <div class="legend-color" style="width: 16px; height: 16px; background: #0ea5e9; border-radius: 2px;"></div>
                            <span style="font-size: 0.85rem; color: var(--muted); font-family: var(--font-mono);">Início</span>
                        </div>
                        <div class="legend-item" style="display: flex; align-items: center; gap: 8px;">
                            <div class="legend-color" style="width: 16px; height: 16px; background: #10b981; border-radius: 2px;"></div>
                            <span style="font-size: 0.85rem; color: var(--muted); font-family: var(--font-mono);">Aquisição</span>
                        </div>
                        <div class="legend-item" style="display: flex; align-items: center; gap: 8px;">
                            <div class="legend-color" style="width: 16px; height: 16px; background: #ef4444; border-radius: 2px;"></div>
                            <span style="font-size: 0.85rem; color: var(--muted); font-family: var(--font-mono);">Perda</span>
                        </div>
                        <div class="legend-item" style="display: flex; align-items: center; gap: 8px;">
                            <div class="legend-color" style="width: 16px; height: 16px; background: #f59e0b; border-radius: 2px;"></div>
                            <span style="font-size: 0.85rem; color: var(--muted); font-family: var(--font-mono);">Final</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- FUNIL DE VENDAS -->
    <section>
        <div class="container">
            <h2 class="section-title">Funil de Conversão</h2>
            <p class="section-subtitle">Fluxo de Orçamentos para Faturas.</p>

            <div class="funnel-wrapper">
                <!-- DIGITAL -->
                <div class="funnel-col">
                    <div class="funnel-header text-orange">DIGITAL</div>
                    <div class="funnel-block funnel-top bg-grad-orange">
                        <div class="f-num">699</div>
                        <div class="f-label">Orçamentos</div>
                    </div>
                    <div class="conversion-pill text-orange">45.4%</div>
                    <div class="funnel-block funnel-bottom bg-flat-orange">
                        <div class="f-num">317</div>
                        <div class="f-label">Faturas</div>
                    </div>
                </div>

                <!-- IMACX -->
                <div class="funnel-col">
                    <div class="funnel-header text-red">IMACX</div>
                    <div class="funnel-block funnel-top bg-grad-red">
                        <div class="f-num">2,836</div>
                        <div class="f-label">Orçamentos</div>
                    </div>
                    <div class="conversion-pill text-red">54.0%</div>
                    <div class="funnel-block funnel-bottom bg-flat-red">
                        <div class="f-num">1,530</div>
                        <div class="f-label">Faturas</div>
                    </div>
                </div>
            </div>

            <div class="insights-box">
                <h3>Conclusão do Funil</h3>
                <ul class="insights-list">
                    <li>A DIGITAL precisa aumentar a entrada de orçamentos em <strong>+305%</strong> para igualar o output da IMACX.</li>
                    <li>Melhorar a taxa de conversão (de 45% para 54%) teria impacto positivo, mas marginal comparado com o problema de volume no topo do funil.</li>
                </ul>
            </div>
        </div>
    </section>

    <!-- VOLUME DE RECEITA E TRANSAÇÕES -->
    <section>
        <div class="container">
            <h2 class="section-title">Volume de Receita e Transações</h2>
            <p class="section-subtitle">Comparação direta de volume financeiro e operacional.</p>

            <div class="grid-2">
                <div class="chart-container" style="height: 400px;">
                    <canvas id="volumeChart"></canvas>
                </div>

                <div class="insights-box" style="margin-top: 0; display: flex; flex-direction: column; justify-content: center;">
                    <h3 style="margin-bottom: 20px;">Análise de Volume Transacional</h3>
                    <ul class="insights-list" style="grid-template-columns: 1fr;">
                        <li>IMACX opera <strong class="text-red">4.8x mais transações</strong> que DIGITAL (1,530 vs 317 faturas).</li>
                        <li>Receita IMACX é <strong class="text-red">2.8x maior</strong> (€2.6M vs €937K), apesar do ticket médio inferior.</li>
                        <li>Base de clientes <strong class="text-red">3.3x maior</strong> (103 vs 31 clientes), resultando em maior diversificação.</li>
                        <li>Ticket médio superior do DIGITAL (<strong class="text-green">€2,958 vs €1,700</strong>) não compensa o baixo volume de operações.</li>
                        <li><strong>Conclusão chave:</strong> Estratégia volumétrica supera estratégia de valor unitário no contexto atual do mercado.</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- WATERFALL E CAUSAS -->
    <section>
        <div class="container">
            <h2 class="section-title">Análise de Root Causes</h2>
            <p class="section-subtitle">Hierarquia de problemas e classificação por criticidade.</p>

            <div class="grid-2">
                <!-- Diagrama -->
                <div class="root-cause-wrapper">
                    <h3 style="text-align: center; margin-bottom: 20px; color: var(--accent-100); flex-shrink: 0;">Hierarquia de Problemas DIGITAL</h3>
                    
                    <div class="rc-tree">
                        <!-- Level 1 -->
                        <div class="rc-node rc-primary">
                            <div class="rc-title">Volume de atividade comercial insuficiente</div>
                            <div class="rc-metric">(-75.4% vs IMACX)</div>
                        </div>
                        
                        <div class="rc-connector-v"></div>
                        
                        <!-- Level 2 -->
                        <div class="rc-row">
                            <div class="rc-node rc-secondary">
                                <div class="rc-title">Erosão de base</div>
                                <div class="rc-metric">(-13.9% net growth)</div>
                            </div>
                            <div class="rc-node rc-secondary">
                                <div class="rc-title">Concentração HH</div>
                                <div class="rc-metric">(78.3% receita)</div>
                            </div>
                            <div class="rc-node rc-secondary">
                                <div class="rc-title">Posicionamento</div>
                                <div class="rc-metric">(Premium limita volume)</div>
                            </div>
                        </div>

                        <div class="rc-connector-v"></div>

                        <!-- Level 3 -->
                        <div class="rc-row">
                            <div class="rc-node rc-tertiary">
                                <div class="rc-title">Aquisição baixa</div>
                                <div class="rc-metric">+12 vs +57</div>
                            </div>
                            <div class="rc-node rc-tertiary">
                                <div class="rc-title">Projetos grandes</div>
                                <div class="rc-metric">8 vs 56</div>
                            </div>
                            <div class="rc-node rc-tertiary">
                                <div class="rc-title">Conversão</div>
                                <div class="rc-metric">-8.6pp</div>
                            </div>
                            <div class="rc-node rc-tertiary">
                                <div class="rc-title">Ticket alto</div>
                                <div class="rc-metric">+74%</div>
                            </div>
                        </div>
                    </div>

                    <div class="insights-box" style="margin-top: 30px; flex-shrink: 0;">
                        <h3 style="margin-bottom: 10px;">Diagnóstico Central</h3>
                        <p>O problema não está na eficiência comercial (45.4% conversão é competitiva), mas na capacidade de gerar volume suficiente de oportunidades. A estratégia premium não compensa o baixo volume transacional.</p>
                    </div>
                </div>

                <!-- Classification -->
                <div class="traffic-light-col">
                    <h2 class="section-title" style="font-size: 1.5rem; margin-bottom: 20px; flex-shrink: 0;">Classificação de Fatores</h2>
                    
                    <div style="display: flex; flex-direction: column; flex: 1; justify-content: space-between;">
                    
                        <!-- CRITICO -->
                        <div class="card" style="border-left: 4px solid var(--destructive); margin-bottom: 20px; padding: 20px;">
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px;">
                                <i class="fas fa-exclamation-circle text-red" style="font-size: 1.2rem;"></i>
                                <h3 style="margin:0; color: var(--destructive);">CRÍTICO</h3>
                            </div>
                            <ul class="simple-list">
                                <li>Volume de atividade comercial <strong class="text-red">-75.4%</strong> vs IMACX</li>
                                <li>Erosão da base de clientes <strong class="text-red">-13.9%</strong> net growth</li>
                                <li>Concentração de receita <strong class="text-red">78.3%</strong> em HH Group</li>
                                <li>Incapacidade de capturar grandes projetos (<strong class="text-red">8</strong> vs <strong class="text-red">56</strong>)</li>
                            </ul>
                        </div>

                        <!-- MODERADO -->
                        <div class="card" style="border-left: 4px solid var(--warning); margin-bottom: 20px; padding: 20px;">
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px;">
                                <i class="fas fa-exclamation-triangle text-orange" style="font-size: 1.2rem;"></i>
                                <h3 style="margin:0; color: var(--warning);">MODERADO</h3>
                            </div>
                            <ul class="simple-list">
                                <li>Gap de conversão <strong class="text-orange">-8.6pp</strong> vs IMACX</li>
                            </ul>
                        </div>

                        <!-- VANTAGEM -->
                        <div class="card" style="border-left: 4px solid var(--success); padding: 20px;">
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px;">
                                <i class="fas fa-check-circle text-green" style="font-size: 1.2rem;"></i>
                                <h3 style="margin:0; color: var(--success);">VANTAGEM</h3>
                            </div>
                            <ul class="simple-list">
                                <li>Ticket médio superior <strong class="text-green">+74%</strong> vs IMACX</li>
                                <li>Valor médio de orçamento <strong class="text-green">+52%</strong> vs IMACX</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- PLANO DE AÇÃO -->
    <section>
        <div class="container">
            <h2 class="section-title">Plano de Ação Recomendado</h2>
            <p class="section-subtitle">Passos estratégicos para os próximos 6-12 meses.</p>

            <div class="rec-item priority-high">
                <div class="rec-number">1</div>
                <div>
                    <h3 style="color: var(--foreground); margin-bottom: 8px;">Campanha de Prospecção Massiva <span class="badge badge-destructive">URGENTE</span></h3>
                    <p>O gap de volume é o problema #1. É necessário multiplicar a entrada de novos orçamentos.</p>
                    <div class="rec-stats">
                        <div class="stat-chip"><span class="stat-lbl">Meta</span> <span class="stat-val">+300% Orçamentos</span></div>
                        <div class="stat-chip"><span class="stat-lbl">Prazo</span> <span class="stat-val">6 Meses</span></div>
                        <div class="stat-chip"><span class="stat-lbl">Ação</span> <span class="stat-val">Expansão Comercial</span></div>
                    </div>
                </div>
            </div>

            <div class="rec-item priority-high">
                <div class="rec-number">2</div>
                <div>
                    <h3 style="color: var(--foreground); margin-bottom: 8px;">Diversificação de Clientes <span class="badge badge-destructive">CRÍTICO</span></h3>
                    <p>Reduzir a dependência extrema do HH Group (78% da receita). O risco de concentração é existencial para a unidade DIGITAL.</p>
                    <div class="rec-stats">
                        <div class="stat-chip"><span class="stat-lbl">Meta</span> <span class="stat-val">100+ Clientes</span></div>
                        <div class="stat-chip"><span class="stat-lbl">Risco Atual</span> <span class="stat-val">Extremo</span></div>
                    </div>
                </div>
            </div>

            <div class="rec-item priority-med">
                <div class="rec-number">3</div>
                <div>
                    <h3 style="color: var(--foreground); margin-bottom: 8px;">Otimização de Processo</h3>
                    <p>Elevar a taxa de conversão de 45% para o benchmark de 54% da IMACX através de melhor follow-up.</p>
                    <div class="rec-stats">
                        <div class="stat-chip"><span class="stat-lbl">Impacto</span> <span class="stat-val">+19% Faturas</span></div>
                        <div class="stat-chip"><span class="stat-lbl">Prioridade</span> <span class="stat-val">Média</span></div>
                    </div>
                </div>
            </div>
        </div>
    </section>


    <!-- PRODUTIVIDADE & ENGAGEMENT -->
    <section>
        <div class="container">
            <h2 class="section-title">Produtividade e Engagement</h2>
            <p class="section-subtitle">Análise de métricas por cliente.</p>

            <div class="grid-2">
                <!-- Gráfico Radar -->
                <div class="chart-container" style="display: flex; flex-direction: column; height: fit-content; max-height: 100%;">
                    <div style="position: relative; width: 100%; height: 400px;">
                        <canvas id="radarChart"></canvas>
                    </div>
                    <!-- Legenda Personalizada -->
                    <div style="display: flex; justify-content: center; gap: 20px; margin-top: 15px;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 16px; height: 16px; background-color: rgba(255, 153, 0, 0.7); border-radius: 2px;"></div>
                            <span style="font-size: 0.85rem; color: #a0a0a0; font-family: var(--font-mono);">DIGITAL</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 16px; height: 16px; background-color: rgba(230, 138, 0, 0.7); border-radius: 2px;"></div>
                            <span style="font-size: 0.85rem; color: #a0a0a0; font-family: var(--font-mono);">IMACX</span>
                        </div>
                    </div>
                </div>

                <!-- Insights -->
                <div style="display: flex; flex-direction: column; height: 100%;">
                    <div class="insights-box" style="margin-top: 0; height: 100%;">
                        <h3 style="margin-bottom: 20px;">Insights por Cliente</h3>
                        <ul class="insights-list" style="grid-template-columns: 1fr;">
                            <li>DIGITAL apresenta <strong class="text-green">receita média por cliente 19.7% superior</strong> (€30,225 vs €25,244), mas esta vantagem é anulada pelo baixo volume de clientes.</li>
                            <li>IMACX demonstra <strong class="text-orange">maior frequência transacional</strong> com <strong class="text-green">+45.1%</strong> faturas por cliente (14.9 vs 10.2), indicando maior recorrência.</li>
                            <li>Atividade comercial por cliente também é superior em IMACX: <strong class="text-green">+22.2%</strong> orçamentos por cliente (27.5 vs 22.5).</li>
                            <li>Taxa de conversão IMACX <strong class="text-green">18.9% superior</strong> (54.0% vs 45.4%), refletindo melhor qualificação de oportunidades.</li>
                        </ul>

                        <!-- Nota de Concentração -->
                        <div class="card" style="margin-top: 20px; border-color: var(--warning); background: rgba(245, 158, 11, 0.1);">
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                <i class="fas fa-exclamation-triangle text-orange"></i>
                                <strong class="text-orange">Risco de Concentração</strong>
                            </div>
                            <p style="font-size: 0.9rem; margin-bottom: 15px;">
                                Excluindo HH Group (78.3% da receita), a receita média por cliente DIGITAL cai para apenas <strong class="text-orange">€6,174</strong> — valor <strong class="text-red">4.1x inferior</strong> à média IMACX.
                            </p>
                            <div style="display: flex; gap: 15px;">
                                <div style="flex: 1; background: rgba(0,0,0,0.3); padding: 8px; border-radius: 4px;">
                                    <div class="stat-lbl">DIGITAL sem HH</div>
                                    <div class="stat-val text-orange">€6,174</div>
                                </div>
                                <div style="flex: 1; background: rgba(0,0,0,0.3); padding: 8px; border-radius: 4px;">
                                    <div class="stat-lbl">IMACX Média</div>
                                    <div class="stat-val text-red">€25,244</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- PIPELINE DISTRIBUTION -->
    <section>
        <div class="container">
            <h2 class="section-title">Distribuição de Pipeline por Tier</h2>
            <p class="section-subtitle">Análise de Quantidade vs Valor Financeiro.</p>

            <div class="grid-2">
                <!-- Quantidade -->
                <div>
                    <h3 style="text-align: center; margin-bottom: 15px;">Distribuição por Quantidade</h3>
                    <p style="text-align: center; color: var(--muted); font-size: 0.9rem; margin-bottom: 20px;">Orçamentos por escalão de valor</p>
                    <div class="chart-container" style="height: 455px;">
                        <canvas id="quantityChart"></canvas>
                    </div>
                </div>

                <!-- Valor -->
                <div>
                    <h3 style="text-align: center; margin-bottom: 15px;">Distribuição por Valor</h3>
                    <p style="text-align: center; color: var(--muted); font-size: 0.9rem; margin-bottom: 20px;">Volume financeiro por escalão (€)</p>
                    <div class="chart-container" style="height: 455px;">
                        <canvas id="valueChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="insights-box">
                <div style="display: flex; gap: 15px; align-items: flex-start;">
                    <i class="fas fa-lightbulb text-orange" style="font-size: 1.5rem; margin-top: 5px;"></i>
                    <p style="font-size: 1rem; line-height: 1.6;">
                        <strong class="text-red">IMACX</strong> executa <strong class="text-red">7x mais projetos grandes</strong> (€30K+: 56 vs 8) representando <strong class="text-red">36.7% do seu pipeline</strong> vs apenas 9.2% no DIGITAL. Além disso, IMACX captura <strong class="text-red">6.4x mais volume</strong> em pequenos projetos (€0-1.5K: 1.679 vs 262), demonstrando maior eficiência em todos os segmentos.
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- YoY TRAJECTORIES -->
    <section>
        <div class="container">
            <h2 class="section-title">Trajetórias YoY e Projeção 2025</h2>
            <p class="section-subtitle">Análise de Tendência e Gap Evolution.</p>

            <div class="grid-2">
                <!-- Gráfico -->
                <div class="chart-container" style="height: 450px;">
                    <canvas id="trajectoryChart"></canvas>
                    <!-- Legenda Personalizada -->
                    <div style="display: flex; justify-content: center; gap: 20px; margin-top: 10px; padding-top: 20px;">
                        <div style="display: flex; align-items: center; gap: 5px;">
                            <div style="width: 20px; height: 3px; background-color: #ff9900;"></div>
                            <span style="font-size: 0.8rem; color: #a0a0a0; font-family: var(--font-mono);">DIGITAL</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 5px;">
                            <div style="width: 20px; height: 3px; background-color: #0ea5e9;"></div>
                            <span style="font-size: 0.8rem; color: #a0a0a0; font-family: var(--font-mono);">IMACX</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 5px; margin-left: 15px;">
                            <div style="width: 20px; height: 3px; border-top: 3px dashed #666;"></div>
                            <span style="font-size: 0.8rem; color: #666;">Projeção</span>
                        </div>
                    </div>
                </div>

                <!-- Gap Analysis -->
                <div style="display: flex; flex-direction: column; justify-content: center;">
                    
                    <!-- Gap Card -->
                    <div class="card" style="background: rgba(30, 30, 30, 0.5); margin-bottom: 20px;">
                        <h3 style="margin-bottom: 15px; font-size: 1.1rem; color: var(--foreground);">Evolução do Gap (IMACX vs DIGITAL)</h3>
                        
                        <div style="display: grid; grid-template-columns: 1fr; gap: 10px;">
                            <div style="display: flex; justify-content: space-between; padding-bottom: 8px; border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <span class="text-muted">Gap 2024 YTD</span>
                                <span class="text-red" style="font-weight: 700;">€904,282 (+55%)</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding-bottom: 8px; border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <span class="text-muted">Gap 2025 YTD</span>
                                <span class="text-red" style="font-weight: 700;">€1,662,793 (+177%)</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span class="text-muted">Aceleração Gap</span>
                                <span class="text-red" style="font-weight: 700;">+84% em 1 ano</span>
                            </div>
                        </div>
                    </div>

                    <div class="insights-box" style="margin-top: 0;">
                        <ul class="insights-list" style="grid-template-columns: 1fr;">
                            <li><strong class="text-red">Trajetórias divergentes aceleradas:</strong> DIGITAL em queda de <strong class="text-red">-43%</strong> enquanto IMACX mantém crescimento de <strong class="text-green">+2.1%</strong>.</li>
                            <li>Se tendências se mantiverem, gap de receita aumentará de €900K para <strong class="text-red">€2.1M</strong> até final de 2025.</li>
                            <li>Projeção 2025 DIGITAL: <strong>~€1.2M</strong> (-50% vs 2024 completo).</li>
                            <li>Projeção 2025 IMACX: <strong>~€3.3M</strong> (+5% vs 2024 completo).</li>
                            <li>Aceleração de divergência: <strong class="text-red">+133%</strong> no gap de receita até final do ano.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

    </section>

    <!-- RECOMENDAÇÕES CRÍTICAS -->
    <section>
        <div class="container">
            <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 1rem;">
                <h2 class="section-title" style="margin: 0;">Recomendações <span class="text-red">CRÍTICAS</span></h2>
                <span style="background: rgba(255,255,255,0.1); padding: 4px 12px; border-radius: 20px; font-size: 0.8rem; border: 1px solid var(--border); font-family: var(--font-mono);">3-6 meses</span>
            </div>
            <p class="section-subtitle">Ações táticas de impacto imediato na performance.</p>

            <style>
                .crit-card {
                    display: grid;
                    grid-template-columns: 50px 1fr 100px;
                    background: var(--surface-highlight);
                    border: 1px solid var(--border);
                    border-radius: 8px;
                    padding: 24px;
                    margin-bottom: 20px;
                    gap: 24px;
                    transition: transform 0.2s;
                }
                .crit-card:hover { transform: translateX(5px); border-color: var(--accent-200); }
                
                .crit-number {
                    width: 40px; height: 40px;
                    background: rgba(255,255,255,0.05);
                    border-radius: 50%;
                    display: flex; align-items: center; justify-content: center;
                    font-weight: 700; font-family: var(--font-mono);
                    color: var(--muted);
                    margin-bottom: 10px;
                }
                .crit-icon { font-size: 1.2rem; color: var(--accent-100); text-align: center; }
                
                .crit-metrics {
                    display: flex;
                    gap: 20px;
                    margin-top: 15px;
                    background: rgba(0,0,0,0.2);
                    padding: 12px;
                    border-radius: 6px;
                    flex-wrap: wrap;
                }
                .crit-m-item { flex: 1; min-width: 80px; }
                .crit-m-lbl { font-size: 0.7rem; color: var(--muted); text-transform: uppercase; margin-bottom: 2px; }
                .crit-m-val { font-weight: 700; color: var(--foreground); font-size: 0.95rem; }
                
                .crit-impact { text-align: right; }
                .impact-tag {
                    display: inline-block;
                    padding: 4px 8px;
                    border-radius: 4px;
                    font-size: 0.75rem;
                    font-weight: 700;
                    text-transform: uppercase;
                    background: rgba(255,255,255,0.05);
                }
                .impact-high { color: var(--destructive); border: 1px solid rgba(239, 68, 68, 0.3); }
                .impact-med { color: var(--warning); border: 1px solid rgba(245, 158, 11, 0.3); }

                .t-box { margin-top: 15px; }
                .t-bar { height: 4px; background: #333; border-radius: 2px; overflow: hidden; }
                .t-fill { height: 100%; background: var(--accent-200); }
                .t-lbl { font-size: 0.75rem; color: var(--muted); margin-top: 5px; font-family: var(--font-mono); }
            </style>

            <!-- Card 1 -->
            <div class="crit-card">
                <div style="display: flex; flex-direction: column; align-items: center;">
                    <div class="crit-number">1</div>
                    <div class="crit-icon"><i class="fas fa-tags"></i></div>
                </div>
                <div>
                    <h3 style="margin-bottom: 8px; color: var(--foreground);">Teste de Estratégia de Preços</h3>
                    <p style="font-size: 0.95rem; margin-bottom: 0; color: var(--muted);">Implementar redução seletiva de preços em segmentos específicos para testar elasticidade da demanda e aumentar competitividade.</p>
                    
                    <div class="crit-metrics">
                        <div class="crit-m-item">
                            <div class="crit-m-lbl">Redução</div>
                            <div class="crit-m-val text-red">-20%</div>
                        </div>
                        <div class="crit-m-item">
                            <div class="crit-m-lbl">Segmento Alvo</div>
                            <div class="crit-m-val">&lt;€10K</div>
                        </div>
                        <div class="crit-m-item">
                            <div class="crit-m-lbl">Monitoramento</div>
                            <div class="crit-m-val">Margens</div>
                        </div>
                    </div>

                    <div class="t-box">
                        <div class="t-bar"><div class="t-fill" style="width: 30%"></div></div>
                        <div class="t-lbl">Implementação Q1</div>
                    </div>
                </div>
                <div class="crit-impact">
                    <span class="impact-tag impact-med">Médio</span>
                </div>
            </div>

            <!-- Card 2 -->
            <div class="crit-card">
                <div style="display: flex; flex-direction: column; align-items: center;">
                    <div class="crit-number">2</div>
                    <div class="crit-icon"><i class="fas fa-project-diagram"></i></div>
                </div>
                <div>
                    <h3 style="margin-bottom: 8px; color: var(--foreground);">Capacidade para Grandes Projetos</h3>
                    <p style="font-size: 0.95rem; margin-bottom: 0; color: var(--muted);">Desenvolver competências e metodologias para captura de grandes oportunidades, atualmente sub-representadas no portfolio.</p>
                    
                    <div class="crit-metrics">
                        <div class="crit-m-item">
                            <div class="crit-m-lbl">Projetos €30K+</div>
                            <div class="crit-m-val">25</div>
                        </div>
                        <div class="crit-m-item">
                            <div class="crit-m-lbl">Status Atual</div>
                            <div class="crit-m-val">8 projetos</div>
                        </div>
                        <div class="crit-m-item">
                            <div class="crit-m-lbl">Deadline</div>
                            <div class="crit-m-val">Fim 2025</div>
                        </div>
                    </div>

                    <div class="t-box">
                        <div class="t-bar"><div class="t-fill" style="width: 15%"></div></div>
                        <div class="t-lbl">RFP tracking, parcerias estratégicas</div>
                    </div>
                </div>
                <div class="crit-impact">
                    <span class="impact-tag impact-high">ALTO</span>
                </div>
            </div>

            <!-- Card 3 -->
            <div class="crit-card">
                <div style="display: flex; flex-direction: column; align-items: center;">
                    <div class="crit-number">3</div>
                    <div class="crit-icon"><i class="fas fa-chart-line"></i></div>
                </div>
                <div>
                    <h3 style="margin-bottom: 8px; color: var(--foreground);">Melhorar Taxa de Conversão</h3>
                    <p style="font-size: 0.95rem; margin-bottom: 0; color: var(--muted);">Implementar processos para aumentar eficiência de conversão de orçamentos, reduzindo o gap vs IMACX.</p>
                    
                    <div class="crit-metrics">
                        <div class="crit-m-item">
                            <div class="crit-m-lbl">Conversão Atual</div>
                            <div class="crit-m-val">45.4%</div>
                        </div>
                        <div class="crit-m-item">
                            <div class="crit-m-lbl">Meta</div>
                            <div class="crit-m-val text-green">52.0%</div>
                        </div>
                        <div class="crit-m-item">
                            <div class="crit-m-lbl">Receita Adicional</div>
                            <div class="crit-m-val text-green">+€136K</div>
                        </div>
                    </div>

                    <div class="t-box">
                        <div class="t-bar"><div class="t-fill" style="width: 50%"></div></div>
                        <div class="t-lbl">Implementação progressiva</div>
                    </div>
                </div>
                <div class="crit-impact">
                    <span class="impact-tag impact-med">MÉDIO</span>
                </div>
            </div>

        </div>
    </section>

    <!-- CENÁRIOS -->
    <section>
        <div class="container">
            <h2 class="section-title">Cenários de Evolução (2025-2027)</h2>
            <p class="section-subtitle">Projeções de impacto baseadas no nível de intervenção.</p>

            <div class="grid-2">
                <!-- Chart -->
                <div class="chart-container" style="height: 500px;">
                    <canvas id="scenarioChart"></canvas>
                    <!-- Custom Legend -->
                    <div style="display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; margin-top: 15px; padding: 20px 20px 0 20px;">
                        <div style="display: flex; align-items: center; gap: 6px;">
                            <div style="width: 12px; height: 12px; background: #e68a00; border-radius: 50%;"></div>
                            <span style="font-size: 0.75rem; color: var(--muted); font-family: var(--font-mono);">A: Status Quo</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 6px;">
                            <div style="width: 12px; height: 12px; background: #ff9900; border-radius: 50%;"></div>
                            <span style="font-size: 0.75rem; color: var(--muted); font-family: var(--font-mono);">B: Tático</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 6px;">
                            <div style="width: 12px; height: 12px; background: #ffa726; border-radius: 50%;"></div>
                            <span style="font-size: 0.75rem; color: var(--muted); font-family: var(--font-mono);">C: Estrutural</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 6px;">
                            <div style="width: 12px; height: 12px; background: #ffb74d; border-radius: 50%;"></div>
                            <span style="font-size: 0.75rem; color: var(--muted); font-family: var(--font-mono);">D: Completo</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 6px;">
                            <div style="width: 20px; height: 2px; border-top: 2px dashed #666;"></div>
                            <span style="font-size: 0.75rem; color: var(--muted); font-family: var(--font-mono);">Benchmark</span>
                        </div>
                    </div>
                </div>

                <!-- Analysis -->
                <div style="display: flex; flex-direction: column; justify-content: center;">
                    <div class="insights-box" style="margin-top: 0;">
                        <h3 style="margin-bottom: 20px;">Análise de Cenários</h3>
                        <ul class="simple-list">
                            <li style="margin-bottom: 15px; padding-left: 0; display: flex; gap: 10px;">
                                <i class="fas fa-times-circle" style="color: #e63946; margin-top: 3px;"></i>
                                <div>
                                    <strong style="color: #e63946;">Cenário A (Status Quo):</strong> Sem intervenção, queda continua até <strong>-67% vs 2024</strong> em 2026. Risco de <strong>inviabilidade operacional</strong>.
                                </div>
                            </li>
                            <li style="margin-bottom: 15px; padding-left: 0; display: flex; gap: 10px;">
                                <i class="fas fa-exclamation-circle" style="color: #ff9f1c; margin-top: 3px;"></i>
                                <div>
                                    <strong style="color: #ff9f1c;">Cenário B (Tático):</strong> Execução apenas de ações URGENTES. Estabiliza, mas não recupera, permanecendo <strong>30% abaixo</strong> de 2024.
                                </div>
                            </li>
                            <li style="margin-bottom: 15px; padding-left: 0; display: flex; gap: 10px;">
                                <i class="fas fa-check-circle" style="color: #118ab2; margin-top: 3px;"></i>
                                <div>
                                    <strong style="color: #118ab2;">Cenário C (Estrutural):</strong> Execução de ações URGENTES + CRÍTICAS. Permite <strong>recuperação gradual</strong> para patamar próximo a 2024.
                                </div>
                            </li>
                            <li style="margin-bottom: 15px; padding-left: 0; display: flex; gap: 10px;">
                                <i class="fas fa-star" style="color: #57a773; margin-top: 3px;"></i>
                                <div>
                                    <strong style="color: #57a773;">Cenário D (Completo):</strong> Único que permite <strong>convergência com IMACX</strong> até 2027, com crescimento de +20% vs 2024.
                                </div>
                            </li>
                        </ul>

                        <div class="card" style="margin-top: 20px; border-color: var(--destructive); background: rgba(239, 68, 68, 0.1);">
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                <i class="fas fa-exclamation-triangle text-red"></i>
                                <strong class="text-red">Decisão Crítica</strong>
                            </div>
                            <p style="font-size: 0.9rem; margin: 0; color: var(--foreground);">
                                Sem implementação <strong>imediata</strong> das ações URGENTES, cenário de inviabilidade em 18-24 meses é <strong>inevitável</strong>.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- CONCLUSÕES -->
    <section>
        <div class="container">
            <h2 class="section-title">Conclusões e Próximos Passos</h2>
            <p class="section-subtitle">Roadmap para execução e tomada de decisão.</p>

            <style>
                .decision-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 40px; align-items: start; }
                
                /* Decisions Column */
                .d-item {
                    display: flex; gap: 15px; background: var(--surface-highlight);
                    padding: 20px; border-radius: 8px; margin-bottom: 15px;
                    border-left: 4px solid var(--border);
                    transition: border-color 0.2s;
                }
                .d-item:hover { border-left-color: var(--accent-100); }
                .d-icon { 
                    width: 40px; height: 40px; background: rgba(255,255,255,0.05); 
                    border-radius: 50%; display: flex; align-items: center; justify-content: center;
                    flex-shrink: 0; color: var(--accent-100);
                }
                .d-title { font-weight: 700; margin-bottom: 5px; color: var(--foreground); font-size: 1rem; }
                .d-desc { font-size: 0.9rem; color: var(--muted); margin: 0; line-height: 1.5; }

                .cta-btn {
                    background: linear-gradient(90deg, var(--destructive), #b91c1c);
                    color: white; border: none; padding: 15px 30px;
                    border-radius: 6px; font-weight: 700; font-size: 1rem;
                    cursor: pointer; width: 100%; margin-top: 20px;
                    display: flex; align-items: center; justify-content: center; gap: 10px;
                    text-transform: uppercase; letter-spacing: 0.05em;
                    transition: opacity 0.2s;
                }
                .cta-btn:hover { opacity: 0.9; }

                /* Timeline Column */
                .tl-list { position: relative; padding-left: 20px; border-left: 2px solid var(--border); margin-left: 10px; }
                .tl-item { position: relative; margin-bottom: 30px; padding-left: 20px; }
                .tl-dot { 
                    position: absolute; left: -29px; top: 0; width: 16px; height: 16px; 
                    background: var(--background); border: 2px solid var(--accent-100); border-radius: 50%; 
                }
                .tl-date { 
                    font-family: var(--font-mono); font-size: 0.85rem; color: var(--accent-100); 
                    margin-bottom: 5px; text-transform: uppercase; display: flex; align-items: center; gap: 10px;
                }
                .tl-tag { 
                    font-size: 0.7rem; padding: 2px 6px; border-radius: 4px; background: var(--destructive); color: white;
                }
                .tl-tag.med { background: var(--warning); color: black; }
                .tl-text { font-size: 0.95rem; color: var(--muted); margin: 0; }
            </style>

            <div class="decision-grid">
                <!-- Column 1: Decisions -->
                <div>
                    <h3 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-balance-scale text-orange"></i> Decisões Executivas
                    </h3>
                    
                    <div class="d-item">
                        <div class="d-icon"><i class="fas fa-users"></i></div>
                        <div>
                            <div class="d-title">Investimento em Recursos</div>
                            <p class="d-desc">DIGITAL necessita reforço de equipa comercial? Volume atual é 75.4% inferior ao IMACX com estrutura operacional similar.</p>
                        </div>
                    </div>

                    <div class="d-item">
                        <div class="d-icon"><i class="fas fa-tags"></i></div>
                        <div>
                            <div class="d-title">Estratégia de Precificação</div>
                            <p class="d-desc">Manter posicionamento premium (+52% vs IMACX) ou reduzir preços em 20% para aumentar competitividade no segmento &lt;€10K?</p>
                        </div>
                    </div>

                    <div class="d-item">
                        <div class="d-icon"><i class="fas fa-exclamation-triangle"></i></div>
                        <div>
                            <div class="d-title">Plano Contingência HH Group</div>
                            <p class="d-desc">Desenvolver estratégia específica para mitigar risco de concentração de 78.3% da receita em cliente único.</p>
                        </div>
                    </div>

                    <div class="d-item">
                        <div class="d-icon"><i class="fas fa-clock"></i></div>
                        <div>
                            <div class="d-title">Checkpoint de Recuperação</div>
                            <p class="d-desc">Definir prazo máximo para avaliação de viabilidade operacional. Declínio de 43% YoY indica trajetória crítica.</p>
                        </div>
                    </div>

                    <button class="cta-btn">
                        <i class="fas fa-file-signature"></i> Aprovar Plano de Ação Urgente
                    </button>
                </div>

                <!-- Column 2: Timeline -->
                <div>
                    <h3 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-tasks text-orange"></i> Plano de Implementação
                    </h3>
                    
                    <div class="tl-list">
                        <div class="tl-item">
                            <div class="tl-dot"></div>
                            <div class="tl-date">Imediato <span class="tl-tag">URGENTE</span></div>
                            <p class="tl-text">Aprovar pacote de ações <strong class="text-orange">urgentes</strong> (0-3 meses) focadas em volume, aquisição de clientes e diversificação da base.</p>
                        </div>

                        <div class="tl-item">
                            <div class="tl-dot"></div>
                            <div class="tl-date">Semana 1-2</div>
                            <p class="tl-text">Designar <strong class="text-orange">responsáveis por iniciativa</strong> com KPIs, metas e cronograma detalhado de implementação.</p>
                        </div>

                        <div class="tl-item">
                            <div class="tl-dot"></div>
                            <div class="tl-date">Mês 1 <span class="tl-tag med">CRÍTICO</span></div>
                            <p class="tl-text">Implementar <strong class="text-orange">sistema CRM</strong> e tracking rigoroso de pipeline para reduzir perda de oportunidades comerciais.</p>
                        </div>

                        <div class="tl-item">
                            <div class="tl-dot"></div>
                            <div class="tl-date">Mensal</div>
                            <p class="tl-text">Estabelecer cadência de <strong class="text-orange">revisão executiva</strong> com monitoramento de KPIs e ajustes ao plano conforme necessário.</p>
                        </div>

                        <div class="tl-item">
                            <div class="tl-dot"></div>
                            <div class="tl-date">Trimestral</div>
                            <p class="tl-text">Checkpoint formal de <strong class="text-orange">progresso vs cenários</strong> para avaliação da trajetória (Cenários A/B/C/D) e decisão de continuidade.</p>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </section>

</main>

<script>
// Configuração Charts
Chart.defaults.color = '#a0a0a0';
Chart.defaults.borderColor = '#333';
Chart.defaults.font.family = 'JetBrains Mono, monospace';

document.addEventListener('DOMContentLoaded', function() {
    
    // 1. Performance Chart
    new Chart(document.getElementById('performanceChart'), {
        type: 'bar',
        data: {
            labels: ['Receita', 'Faturas', 'Clientes', 'Orçamentos', 'Conversão', 'Ticket Médio'],
            datasets: [
                {
                    label: 'DIGITAL',
                    data: [36.0, 20.7, 30.1, 24.6, 84.1, 173.9],
                    backgroundColor: '#ff9900',
                    borderRadius: 4
                },
                {
                    label: 'IMACX (Baseline)',
                    data: [100, 100, 100, 100, 100, 100],
                    backgroundColor: '#ef4444',
                    borderRadius: 4
                }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: { 
                    display: true,
                    position: 'top',
                    labels: { color: '#a0a0a0', font: { family: 'JetBrains Mono' } }
                },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            return context.dataset.label + ': ' + context.raw + '%';
                        }
                    }
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    max: 200,
                    grid: { color: '#333' },
                    ticks: { color: '#a0a0a0', font: { family: 'JetBrains Mono' }, callback: (v) => v + '%' },
                    title: { display: true, text: 'Performance Relativa (%)', color: '#666', font: { family: 'JetBrains Mono' } }
                },
                x: { 
                    grid: { display: false },
                    ticks: { color: '#a0a0a0', font: { family: 'JetBrains Mono' } }
                }
            }
        }
    });

    // 3. Volume Chart
    new Chart(document.getElementById('volumeChart'), {
        type: 'bar',
        data: {
            labels: ['Receita (€K)', 'Faturas', 'Clientes Ativos'],
            datasets: [
                {
                    label: 'DIGITAL',
                    backgroundColor: '#ff9900',
                    data: [937, 317, 31],
                    borderRadius: 4
                },
                {
                    label: 'IMACX',
                    backgroundColor: '#ef4444',
                    data: [2600, 1530, 103],
                    borderRadius: 4
                }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: { 
                    display: true,
                    position: 'top',
                    labels: { color: '#a0a0a0', font: { family: 'JetBrains Mono' } }
                },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            let label = context.dataset.label || '';
                            if (label) { label += ': '; }
                            if (context.parsed.y !== null) {
                                if (context.dataIndex === 0) {
                                    label += '€' + context.parsed.y + 'K';
                                } else {
                                    label += context.parsed.y;
                                }
                            }
                            return label;
                        }
                    }
                }
            },
            scales: {
                y: {
                    grid: { color: '#333' },
                    ticks: { color: '#a0a0a0', font: { family: 'JetBrains Mono' } }
                },
                x: { 
                    grid: { display: false },
                    ticks: { color: '#a0a0a0', font: { family: 'JetBrains Mono' } }
                }
            }
        }
    });

    // 4. Bubble Chart (Strategy)
    const bubbleCtx = document.getElementById('bubbleChart');
    if (bubbleCtx) {
        const digitalRevenue = 937470;
        const imacxRevenue = 2600263;
        const maxRevenue = Math.max(digitalRevenue, imacxRevenue);
        const minBubbleSize = 20;
        const maxBubbleSize = 60;

        const digitalSize = minBubbleSize + (digitalRevenue / maxRevenue) * (maxBubbleSize - minBubbleSize);
        const imacxSize = minBubbleSize + (imacxRevenue / maxRevenue) * (maxBubbleSize - minBubbleSize);

        new Chart(bubbleCtx, {
            type: 'bubble',
            data: {
                datasets: [
                    {
                        label: 'DIGITAL',
                        data: [{ x: 2958, y: 317, r: digitalSize }],
                        backgroundColor: 'rgba(255, 153, 0, 0.7)',
                        borderColor: '#ff9900',
                        borderWidth: 1
                    },
                    {
                        label: 'IMACX',
                        data: [{ x: 1700, y: 1530, r: imacxSize }],
                        backgroundColor: 'rgba(239, 68, 68, 0.7)',
                        borderColor: '#ef4444',
                        borderWidth: 1
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const isDigital = context.dataset.label === 'DIGITAL';
                                const revenue = isDigital ? '€937K' : '€2.6M';
                                const ticket = isDigital ? '€2,958' : '€1,700';
                                const faturas = isDigital ? '317' : '1,530';
                                return [
                                    context.dataset.label,
                                    `Ticket Médio: ${ticket}`,
                                    `Faturas: ${faturas}`,
                                    `Receita Total: ${revenue}`
                                ];
                            }
                        }
                    },
                    title: {
                        display: true,
                        text: 'Tamanho da Bolha = Receita Total',
                        color: '#666',
                        font: { size: 12, weight: 'normal' }
                    }
                },
                scales: {
                    x: {
                        title: { display: true, text: 'Ticket Médio (€)', color: '#a0a0a0', font: { family: 'JetBrains Mono' } },
                        min: 0,
                        max: 3500,
                        grid: { color: '#333' },
                        ticks: { color: '#a0a0a0', font: { family: 'JetBrains Mono' } }
                    },
                    y: {
                        title: { display: true, text: 'Número de Faturas', color: '#a0a0a0', font: { family: 'JetBrains Mono' } },
                        min: 0,
                        max: 1800,
                        grid: { color: '#333' },
                        ticks: { color: '#a0a0a0', font: { family: 'JetBrains Mono' } }
                    }
                }
            }
        });
    }

    // 5. Client Dynamics Waterfall Charts (Canvas Native)
    const digitalCanvas = document.getElementById('digitalWaterfall');
    const imacxCanvas = document.getElementById('imacxWaterfall');
    
    if (digitalCanvas && imacxCanvas) {
        const digitalCtx = digitalCanvas.getContext('2d');
        const imacxCtx = imacxCanvas.getContext('2d');
        
        // Helper function to get color by type
        function getColorByType(type) {
            switch(type) {
                case 'start':
                    return '#0ea5e9'; // Blue - ponto inicial
                case 'add':
                    return '#10b981'; // Green - crescimento positivo
                case 'subtract':
                    return '#ef4444'; // Red - perda
                case 'end':
                    return '#f59e0b'; // Amber - resultado final
                default:
                    return '#ff9900';
            }
        }
        
        // Set canvas dimensions
        function resizeCanvas() {
            const digitalContainer = digitalCanvas.parentElement;
            const imacxContainer = imacxCanvas.parentElement;
            
            const width = digitalContainer.clientWidth;
            const height = digitalContainer.clientHeight;
            
            digitalCanvas.width = width;
            digitalCanvas.height = height;
            imacxCanvas.width = width;
            imacxCanvas.height = height;
            
            drawDigitalWaterfall();
            drawImacxWaterfall();
        }
        
        // Draw Digital waterfall chart
        function drawDigitalWaterfall() {
            const width = digitalCanvas.width;
            const height = digitalCanvas.height;
            const barWidth = width * 0.15;
            const spacing = width * 0.05;
            const startX = width * 0.1;
            
            digitalCtx.clearRect(0, 0, width, height);
            
            const data = [
                { label: 'Início', value: 48, type: 'start' },
                { label: 'Novos', value: 12, type: 'add' },
                { label: 'Perdidos', value: -17, type: 'subtract' },
                { label: 'Final', value: 31, type: 'end' }
            ];
            
            const maxValue = Math.max(...data.map(d => Math.abs(d.value)));
            const scale = (height * 0.7) / (maxValue * 1.2);
            const baseline = height * 0.8;
            
            // Draw axes
            digitalCtx.beginPath();
            digitalCtx.strokeStyle = '#333';
            digitalCtx.moveTo(startX - 20, baseline);
            digitalCtx.lineTo(width - startX, baseline);
            digitalCtx.stroke();
            
            // Draw zero line
            digitalCtx.font = '12px "JetBrains Mono", monospace';
            digitalCtx.fillStyle = '#a0a0a0';
            digitalCtx.textAlign = 'right';
            digitalCtx.fillText('0', startX - 25, baseline + 4);
            
            let currentX = startX;
            let currentValue = 0;
            
            data.forEach((item, index) => {
                const barHeight = Math.abs(item.value) * scale;
                let barY;
                
                const barColor = getColorByType(item.type);
                
                if (item.type === 'start' || item.type === 'end') {
                    barY = baseline - item.value * scale;
                    digitalCtx.fillStyle = barColor;
                    digitalCtx.fillRect(currentX, barY, barWidth, barHeight);
                    
                    digitalCtx.fillStyle = '#f0f0f0';
                    digitalCtx.font = 'bold 16px "JetBrains Mono", monospace';
                    digitalCtx.textAlign = 'center';
                    digitalCtx.fillText(item.value, currentX + barWidth/2, barY - 10);
                    
                    currentValue = item.value;
                } else if (item.type === 'add') {
                    barY = baseline - item.value * scale - currentValue * scale;
                    digitalCtx.fillStyle = barColor;
                    digitalCtx.fillRect(currentX, barY, barWidth, barHeight);
                    
                    if (index > 0) {
                        const prevBarX = currentX - spacing - barWidth;
                        const prevBarY = baseline - currentValue * scale;
                        digitalCtx.beginPath();
                        digitalCtx.strokeStyle = '#666';
                        digitalCtx.setLineDash([3, 3]);
                        digitalCtx.moveTo(prevBarX + barWidth, prevBarY);
                        digitalCtx.lineTo(currentX, prevBarY);
                        digitalCtx.stroke();
                        digitalCtx.setLineDash([]);
                    }
                    
                    digitalCtx.fillStyle = barColor;
                    digitalCtx.font = 'bold 16px "JetBrains Mono", monospace';
                    digitalCtx.textAlign = 'center';
                    digitalCtx.fillText('+' + item.value, currentX + barWidth/2, barY - 10);
                    
                    currentValue += item.value;
                } else if (item.type === 'subtract') {
                    barY = baseline;
                    digitalCtx.fillStyle = barColor;
                    digitalCtx.fillRect(currentX, barY, barWidth, barHeight);
                    
                    if (index > 0) {
                        const prevBarX = currentX - spacing - barWidth;
                        const prevBarY = baseline - currentValue * scale;
                        digitalCtx.beginPath();
                        digitalCtx.strokeStyle = '#666';
                        digitalCtx.setLineDash([3, 3]);
                        digitalCtx.moveTo(prevBarX + barWidth, prevBarY);
                        digitalCtx.lineTo(currentX, prevBarY);
                        digitalCtx.stroke();
                        digitalCtx.setLineDash([]);
                    }
                    
                    digitalCtx.fillStyle = barColor;
                    digitalCtx.font = 'bold 16px "JetBrains Mono", monospace';
                    digitalCtx.textAlign = 'center';
                    digitalCtx.fillText(item.value, currentX + barWidth/2, barY + barHeight + 20);
                    
                    currentValue += item.value;
                }
                
                digitalCtx.fillStyle = '#a0a0a0';
                digitalCtx.font = '14px "JetBrains Mono", monospace';
                digitalCtx.textAlign = 'center';
                digitalCtx.fillText(item.label, currentX + barWidth/2, height - 10);
                
                currentX += barWidth + spacing;
            });
        }
        
        // Draw IMACX waterfall chart
        function drawImacxWaterfall() {
            const width = imacxCanvas.width;
            const height = imacxCanvas.height;
            const barWidth = width * 0.15;
            const spacing = width * 0.05;
            const startX = width * 0.1;
            
            imacxCtx.clearRect(0, 0, width, height);
            
            const data = [
                { label: 'Início', value: 119, type: 'start' },
                { label: 'Novos', value: 57, type: 'add' },
                { label: 'Perdidos', value: -57, type: 'subtract' },
                { label: 'Final', value: 119, type: 'end' }
            ];
            
            const maxValue = Math.max(...data.map(d => Math.abs(d.value)));
            const scale = (height * 0.7) / (maxValue * 1.2);
            const baseline = height * 0.8;
            
            // Draw axes
            imacxCtx.beginPath();
            imacxCtx.strokeStyle = '#333';
            imacxCtx.moveTo(startX - 20, baseline);
            imacxCtx.lineTo(width - startX, baseline);
            imacxCtx.stroke();
            
            // Draw zero line
            imacxCtx.font = '12px "JetBrains Mono", monospace';
            imacxCtx.fillStyle = '#a0a0a0';
            imacxCtx.textAlign = 'right';
            imacxCtx.fillText('0', startX - 25, baseline + 4);
            
            let currentX = startX;
            let currentValue = 0;
            
            data.forEach((item, index) => {
                const barHeight = Math.abs(item.value) * scale;
                let barY;
                
                const barColor = getColorByType(item.type);
                
                if (item.type === 'start' || item.type === 'end') {
                    barY = baseline - item.value * scale;
                    imacxCtx.fillStyle = barColor;
                    imacxCtx.fillRect(currentX, barY, barWidth, barHeight);
                    
                    imacxCtx.fillStyle = '#f0f0f0';
                    imacxCtx.font = 'bold 16px "JetBrains Mono", monospace';
                    imacxCtx.textAlign = 'center';
                    imacxCtx.fillText(item.value, currentX + barWidth/2, barY - 10);
                    
                    if (item.type === 'end') {
                        imacxCtx.font = '12px "JetBrains Mono", monospace';
                        imacxCtx.fillStyle = '#a0a0a0';
                        imacxCtx.fillText('(Ativos: 103)', currentX + barWidth/2, barY - 30);
                    }
                    
                    currentValue = item.value;
                } else if (item.type === 'add') {
                    barY = baseline - item.value * scale - currentValue * scale;
                    imacxCtx.fillStyle = barColor;
                    imacxCtx.fillRect(currentX, barY, barWidth, barHeight);
                    
                    if (index > 0) {
                        const prevBarX = currentX - spacing - barWidth;
                        const prevBarY = baseline - currentValue * scale;
                        imacxCtx.beginPath();
                        imacxCtx.strokeStyle = '#666';
                        imacxCtx.setLineDash([3, 3]);
                        imacxCtx.moveTo(prevBarX + barWidth, prevBarY);
                        imacxCtx.lineTo(currentX, prevBarY);
                        imacxCtx.stroke();
                        imacxCtx.setLineDash([]);
                    }
                    
                    imacxCtx.fillStyle = barColor;
                    imacxCtx.font = 'bold 16px "JetBrains Mono", monospace';
                    imacxCtx.textAlign = 'center';
                    imacxCtx.fillText('+' + item.value, currentX + barWidth/2, barY - 10);
                    
                    currentValue += item.value;
                } else if (item.type === 'subtract') {
                    barY = baseline;
                    imacxCtx.fillStyle = barColor;
                    imacxCtx.fillRect(currentX, barY, barWidth, barHeight);
                    
                    if (index > 0) {
                        const prevBarX = currentX - spacing - barWidth;
                        const prevBarY = baseline - currentValue * scale;
                        imacxCtx.beginPath();
                        imacxCtx.strokeStyle = '#666';
                        imacxCtx.setLineDash([3, 3]);
                        imacxCtx.moveTo(prevBarX + barWidth, prevBarY);
                        imacxCtx.lineTo(currentX, prevBarY);
                        imacxCtx.stroke();
                        imacxCtx.setLineDash([]);
                    }
                    
                    imacxCtx.fillStyle = barColor;
                    imacxCtx.font = 'bold 16px "JetBrains Mono", monospace';
                    imacxCtx.textAlign = 'center';
                    imacxCtx.fillText(item.value, currentX + barWidth/2, barY + barHeight + 20);
                    
                    currentValue += item.value;
                }
                
                imacxCtx.fillStyle = '#a0a0a0';
                imacxCtx.font = '14px "JetBrains Mono", monospace';
                imacxCtx.textAlign = 'center';
                imacxCtx.fillText(item.label, currentX + barWidth/2, height - 10);
                
                currentX += barWidth + spacing;
            });
        }
        
        // Initial draw
        resizeCanvas();
        
        // Redraw on window resize
        window.addEventListener('resize', resizeCanvas);
    }
    // 6. Radar Chart (Produtividade)
    const radarCtx = document.getElementById('radarChart');
    if (radarCtx) {
        // Raw values for tooltips
        const rawData = {
            DIGITAL: [30225, 10.2, 22.5, 45.4],
            IMACX: [25244, 14.9, 27.5, 54.0]
        };

        // Normalize data for chart drawing (scale 0-100 relative to max of each category)
        // Categories: Revenue, Invoices, Quotes, Conversion
        const maxValues = [30225, 14.9, 27.5, 54.0]; 
        
        const normalize = (val, max) => (val / max) * 100;

        const normalizedData = {
            DIGITAL: rawData.DIGITAL.map((val, i) => normalize(val, maxValues[i])),
            IMACX: rawData.IMACX.map((val, i) => normalize(val, maxValues[i]))
        };

        new Chart(radarCtx.getContext('2d'), {
            type: 'radar',
            data: {
                labels: [
                    'Receita por Cliente (€)',
                    'Faturas por Cliente',
                    'Orçamentos por Cliente',
                    'Taxa de Conversão (%)'
                ],
                datasets: [
                    {
                        label: 'DIGITAL',
                        data: normalizedData.DIGITAL,
                        backgroundColor: 'rgba(255, 153, 0, 0.2)',
                        borderColor: 'rgba(255, 153, 0, 0.7)',
                        pointBackgroundColor: 'rgba(255, 153, 0, 1)',
                        pointHoverBackgroundColor: '#fff',
                        pointBorderColor: '#fff',
                        pointHoverBorderColor: 'rgba(255, 153, 0, 1)',
                        borderWidth: 2
                    },
                    {
                        label: 'IMACX',
                        data: normalizedData.IMACX,
                        backgroundColor: 'rgba(230, 138, 0, 0.2)',
                        borderColor: 'rgba(230, 138, 0, 0.7)',
                        pointBackgroundColor: 'rgba(230, 138, 0, 1)',
                        pointHoverBackgroundColor: '#fff',
                        pointBorderColor: '#fff',
                        pointHoverBorderColor: 'rgba(230, 138, 0, 1)',
                        borderWidth: 2
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                elements: {
                    line: {
                        tension: 0.1
                    }
                },
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                let label = context.dataset.label || '';
                                if (label) {
                                    label += ': ';
                                }
                                
                                const datasetLabel = context.dataset.label;
                                const idx = context.dataIndex;
                                const value = rawData[datasetLabel][idx];

                                if (idx === 0) {
                                    // Receita
                                    label += '€' + value.toLocaleString('pt-PT');
                                } else if (idx === 3) {
                                    // Conversão
                                    label += value + '%';
                                } else {
                                    // Outros
                                    label += value;
                                }
                                return label;
                            }
                        }
                    }
                },
                scales: {
                    r: {
                        angleLines: {
                            display: true,
                            color: 'rgba(255, 255, 255, 0.1)'
                        },
                        suggestedMin: 0,
                        max: 100, // Force scale to 100 since we are normalized
                        ticks: {
                            backdropColor: 'transparent',
                            color: '#a0a0a0',
                            font: {
                                family: 'JetBrains Mono',
                                size: 10
                            },
                            display: false, // Hide ticks because they are normalized (0-100) and would be confusing
                            stepSize: 20
                        },
                        grid: {
                            color: 'rgba(255, 255, 255, 0.1)'
                        },
                        pointLabels: {
                            font: {
                                family: 'JetBrains Mono',
                                size: 12
                            },
                            color: '#a0a0a0'
                        }
                    }
                }
            }
        });
    }
    // 7. Pipeline Distribution Charts
    const quantityChartEl = document.getElementById('quantityChart');
    const valueChartEl = document.getElementById('valueChart');
    
    if (quantityChartEl && valueChartEl) {
        const tiers = ['€0-1.5K', '€1.5-2.5K', '€2.5-7.5K', '€7.5-15K', '€15-30K', '€30K+'];
        // Distinct palette for better visibility across 6 tiers
        const colorPalette = [
            '#94a3b8',   // €0-1.5K (Slate 400)
            '#0ea5e9',   // €1.5-2.5K (Sky 500)
            '#10b981',   // €2.5-7.5K (Emerald 500)
            '#f59e0b',   // €7.5-15K (Amber 500)
            '#f97316',   // €15-30K (Orange 500)
            '#ef4444'    // €30K+ (Red 500)
        ];
        
        const commonOptions = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: { 
                    position: 'bottom',
                    labels: { color: '#a0a0a0', font: { family: 'JetBrains Mono', size: 10 }, boxWidth: 10 }
                }
            },
            scales: {
                x: { stacked: true, grid: { display: false }, ticks: { color: '#a0a0a0', font: { family: 'JetBrains Mono' } } },
                y: { stacked: true, grid: { color: '#333' }, ticks: { color: '#a0a0a0', font: { family: 'JetBrains Mono' } } }
            }
        };

        // Quantity
        new Chart(quantityChartEl, {
            type: 'bar',
            data: {
                labels: ['DIGITAL', 'IMACX'],
                datasets: tiers.map((tier, index) => ({
                    label: tier,
                    data: [
                        [262, 67, 177, 113, 57, 8][index],
                        [1679, 244, 394, 164, 99, 56][index]
                    ],
                    backgroundColor: colorPalette[index],
                    borderRadius: 2
                }))
            },
            options: commonOptions
        });

        // Value
        new Chart(valueChartEl, {
            type: 'bar',
            data: {
                labels: ['DIGITAL', 'IMACX'],
                datasets: tiers.map((tier, index) => ({
                    label: tier,
                    data: [
                        [165, 130, 820, 1232, 1169, 367][index],
                        [789, 470, 1697, 1750, 2034, 3905][index]
                    ],
                    backgroundColor: colorPalette[index],
                    borderRadius: 2
                }))
            },
            options: {
                ...commonOptions,
                scales: {
                    ...commonOptions.scales,
                    y: { ...commonOptions.scales.y, ticks: { callback: (v) => '€' + v + 'K', color: '#a0a0a0', font: { family: 'JetBrains Mono' } } }
                }
            }
        });
    }
    // 8. Trajectory Chart
    const trajectoryChartEl = document.getElementById('trajectoryChart');
    if (trajectoryChartEl) {
        new Chart(trajectoryChartEl, {
            type: 'line',
            data: {
                labels: ['2024', '2025 YTD', '2025 Proj'],
                datasets: [
                    {
                        label: 'DIGITAL',
                        data: [1.64, 0.94, 1.20],
                        borderColor: '#ff9900',
                        backgroundColor: 'rgba(255, 153, 0, 0.1)',
                        borderWidth: 3,
                        pointBackgroundColor: '#ff9900',
                        pointRadius: 5,
                        pointHoverRadius: 7,
                        tension: 0.3,
                        segment: {
                            borderDash: ctx => ctx.p1.parsed.x >= 1 ? [6, 6] : undefined,
                        }
                    },
                    {
                        label: 'IMACX',
                        data: [2.55, 2.60, 3.30],
                        borderColor: '#0ea5e9',
                        backgroundColor: 'rgba(14, 165, 233, 0.1)',
                        borderWidth: 3,
                        pointBackgroundColor: '#0ea5e9',
                        pointRadius: 5,
                        pointHoverRadius: 7,
                        tension: 0.3,
                        segment: {
                            borderDash: ctx => ctx.p1.parsed.x >= 1 ? [6, 6] : undefined,
                        }
                    }
                ]
            },
            options: {
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return context.dataset.label + ': €' + context.raw.toFixed(2) + 'M';
                            }
                        }
                    }
                },
                scales: {
                    x: { grid: { display: false }, ticks: { color: '#a0a0a0', font: { family: 'JetBrains Mono' } } },
                    y: {
                        beginAtZero: true,
                        grid: { color: '#333' },
                        ticks: { callback: (v) => '€' + v + 'M', color: '#a0a0a0', font: { family: 'JetBrains Mono' } },
                        title: { display: true, text: 'Receita (Milhões €)', color: '#666', font: { family: 'JetBrains Mono' } }
                    }
                }
            }
        });
    }
    // 9. Scenario Chart (Evolução 2025-2027)
    const scenarioChartEl = document.getElementById('scenarioChart');
    if (scenarioChartEl) {
        new Chart(scenarioChartEl, {
            type: 'line',
            data: {
                labels: ['2024', '2025', '2026', '2027'],
                datasets: [
                    {
                        label: 'A: Status Quo',
                        data: [1.64, 1.20, 0.80, null],
                        borderColor: '#ef4444', // Red
                        backgroundColor: 'rgba(239, 68, 68, 0.1)',
                        borderWidth: 3,
                        pointRadius: 6,
                        tension: 0.1
                    },
                    {
                        label: 'B: Tático',
                        data: [1.64, 1.40, 1.60, null],
                        borderColor: '#f59e0b', // Orange/Amber
                        backgroundColor: 'rgba(245, 158, 11, 0.1)',
                        borderWidth: 3,
                        pointRadius: 6,
                        tension: 0.1
                    },
                    {
                        label: 'C: Estrutural',
                        data: [1.64, 1.50, 2.20, null],
                        borderColor: '#0ea5e9', // Blue
                        backgroundColor: 'rgba(14, 165, 233, 0.1)',
                        borderWidth: 3,
                        pointRadius: 6,
                        tension: 0.1
                    },
                    {
                        label: 'D: Completo',
                        data: [1.64, 1.50, 2.60, 3.00],
                        borderColor: '#10b981', // Green
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        borderWidth: 3,
                        pointRadius: 6,
                        tension: 0.1
                    },
                    {
                        label: 'IMACX (Benchmark)',
                        data: [2.55, 3.30, 3.50, 3.70],
                        borderColor: '#666',
                        backgroundColor: 'transparent',
                        borderWidth: 2,
                        borderDash: [5, 5],
                        pointRadius: 4,
                        tension: 0.1
                    }
                ]
            },
            options: {
                maintainAspectRatio: false,
                layout: {
                    padding: {
                        bottom: 20
                    }
                },
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        mode: 'index',
                        intersect: false,
                        callbacks: { 
                            label: (ctx) => {
                                if (ctx.raw === null) return ctx.dataset.label + ': N/A';
                                return ctx.dataset.label + ': €' + ctx.raw + 'M';
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        min: 0.5,
                        grid: { color: '#333' },
                        ticks: { callback: (v) => '€' + v + 'M', color: '#a0a0a0', font: { family: 'JetBrains Mono' } },
                        title: { display: true, text: 'Receita (€ Milhões)', color: '#666', font: { family: 'JetBrains Mono' } }
                    },
                    x: { grid: { display: false }, ticks: { color: '#a0a0a0', font: { family: 'JetBrains Mono' } } }
                }
            }
        });
    }
});
</script>
</body>
</html>

